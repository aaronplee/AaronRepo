.TH topgen-mkdns.sh 8 "MAY 2016" "TopGen Simulator" "TopGen Manuals"
.SH NAME
topgen-mkdns.sh \- generate multi-view bind9 configuration for TopGen.
.SH SYNOPSIS
.B topgen-mkdns.sh
[
.B \-fqh
] [
.B \-w
.I web-hosts
] [
.B \-x
.I xtra-hosts
] [
.B \-m
.I mail-hosts
] [
.B \-d
.I delegations
] [
.B \-n
.I dns-hosts
] [
.B \-c
.I named-conf
] [
.B \-z
.I zone-folder
]
.SH DESCRIPTION
.B topgen-mkdns.sh
generates bind9 configuration based on a given set of hosts files
(containing <ip-addr fqdn> pairs), and a list of nameservers acting
as 2nd-level domain delegation targets.
.SH OPTIONS
Options available for the
.B topgen-mkdns.sh
command:
.TP
\fB\-w\fR \fIweb-hosts\fR
Specifies an alternative <ip-addr fqdn> hosts file for httpd vhosts.
.br
This option defaults to \fB\fI/var/lib/topgen/etc/hosts.nginx\fR.
.TP
\fB\-x\fR \fIxtra-hosts\fR
Optionally pecifies an additional <ip-addr fqdn> hosts file to be
added to the simulated DNS database.
.br
This option is useful when the IP addresses in question should \fBnot\fR
be added to the TopGen host's loopback address: in this case, TopGen's
DNS service will resolve the records, but no virtual application server
(httpd or mail) will be offered by TopGen itself under that address or
host name.
.TP
\fB\-m\fR \fImail-hosts\fR
Specifies an alternative <ip-addr fqdn> hosts file for mail servers,
for which MX records are also generated besides the usual A and PTR.
.br
This option defaults to \fB\fI/var/lib/topgen/etc/hosts.vmail\fR.
.TP
\fB\-d\fR \fIdelegations\fR
Specifies an alternative source for 2nd-level (forward) and /24 (reverse)
delegation targets.
.br
This option defaults to \fB\fI/etc/topgen/delegations.dns\fR.
.TP
\fB\-n\fR \fIdns-hosts\fR
Specifies an alternative destination for the <ip-addr fqdn> hosts file
containnig all virtual DNS servers (views) generated by this script.
.br
This option defaults to \fB\fI/var/lib/topgen/etc/hosts.named\fR.
.TP
\fB\-c\fR \fInamed-conf\fR
Specifies an alternative destination for the bind9 named.conf file.
.br
This option defaults to \fB\fI/var/lib/topgen/etc/named.conf\fR.
.TP
\fB\-z\fR \fIzone-folder\fR
Specifies an alternative destination for the location of each zone
file added to named.conf.
.br
This option defaults to \fB\fI/var/lib/topgen/named\fR.
.TP
\fB\-f\fR
Force re-creation of TopGen bind9 configuration.
.br
CAUTION: any pre-existing configuration will be lost!
.TP
\fB\-q\fR
Suppress warnings and success notifications (output will still be
generated if errors are encountered).
.SH "SEE ALSO"
.BR topgen-scrape.sh (8),
.BR topgen-vmail.sh (8)
.SH BUGS
No error checking is performed on the hashes read in from delegations.dns.
SELinux policy for the TopGen package should be sorted out, so we
don't have to manually set context on the various bits and pieces
of generated configuration.
.SH AUTHORS
Gabriel Somlo <glsomlo at cert.org>.
